# **Surrogate Structure-Specific Probabilistic Dynamic Responses of Bridge Portfolios using Deep Learning with Partial Information**

Predicting region-wide structural responses under seismic shaking is essential for enhancing the effectiveness of earthquake engineering task forces such as earthquake early warning and regional seismic risk and resilience assessments. Existing domain-specific and data-driven approaches, however, lack the capability to provide high-fidelity, structure-specific dynamic response predictions for large-scale structural inventories in a timely manner. To address this gap, this study designed a novel deep learning framework, which integrates heterogeneous ground motion sequences and partial structural information as model inputs, to predict structure-specific, probabilistic dynamic responses of regional structural portfolios. Validation on a portfolio of highway bridges in California demonstrates the model’s ability to capture inter-structure response variability by inputting critical and accessible bridge parameters while accounting for uncertainties due to the lack of other information. The results underscore the framework’s efficiency and accuracy, paving the way for various advancements in performance-based earthquake engineering and regional-scale seismic decision-making.

## Introduction
![FIGURE 1. Seismic response prediction supports various task forces in earthquake engineering. (a) Earthquake events in California with magnitude greater than 5.0 from 1900 to 2024. GM records at various locations are available in the NGA West2 database46. (b) Highway systems and pre-1971, two-span bridges in California. Certain geometric parameters of these bridges are available in the NBI database32. (c) Three approaches for dynamic response predictions of bridges under seismic loading. (d) Earthquake early warning system. (e) Regional ground motion simulation through probabilistic seismic hazard analysis. Earthquake rupture forecast adopts the UCERF3 model16 (f) Regional seismic risk and resilience assessments for the functionality recovery curve and seismic risk map5.](https://github.com/Ning-Civil/SPR-Net/blob/main/data/figure_1.png)

## Structural Portfolio Response Prediction Network (SPR-Net)
![FIGURE 2. Schematic framework of the SPR-Net for the seismic response prediction of structure portfolios. (a) The architecture of the designed SPR-Net is composed of fully connected layers processing structure features, and dilated casual convolutional layers processing GM sequence. The features from structure and GM are merged through the gate mechanism. (b) Loss functions for training the SPR-Net. The loss function for the probabilistic prediction is composed of uncertainty loss L_u and data loss L_d. (c) The deterministic SPR-Net with all structure features as inputs and dynamic response history as the output. (d) Feature selection based on Shapley values and data accessibility. (e) The probabilistic SPR-Net with selected key structural parameters and GM sequence as input, and the mean and variance of the dynamic response history as outputs. The model is transferred from the deterministic SPR-Net by freezing the module processing the GM data and fine turning other modules. The distribution of seismic response at each time step is considered to follow a lognormal distribution, and the probabilistic SPR-Net predicts the mean α and variance β of the distribution. ](https://github.com/Ning-Civil/SPR-Net/blob/main/data/figure_2.png)

## Requirements and Installation
tensorflow-gpu version == 2.3.0\n
Python version == 3.7.13
